<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de Cifrados</title>
    <link rel="stylesheet" href="assets/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        .selected-measure {
            background-color: #d1e7ff !important;
            box-shadow: inset 0 0 0 2px #007bff;
        }
        .chart-list {
            margin-top: 15px;
            max-height: 400px;
            overflow-y: auto;
        }
        .chart-list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
        }
        .chart-list-item:hover {
            background-color: #bb86fc;
            color: #121212;
        }
        .chart-list-item:hover span {
            color: #121212;
        }
        .chart-list-item span {
            /* cursor: pointer; no longer needed here */
        }
        .chart-list-item .actions button {
            margin-left: 5px;
        }
        #load-chart-modal .modal-content {
            width: 600px;
        }
        #save-chart-modal .modal-content {
            width: 600px;
            height: auto;
        }

        /* Aumentar altura de elementos en modales */
        .modal-content select,
        .modal-content input[type="text"],
        .modal-content .btn-action {
            padding-top: 10px;
            padding-bottom: 10px;
            font-size: 1.1em;
        }

        #load-chart-modal .modal-content,
        #save-chart-modal .modal-content {
            gap: 15px;
        }
    </style>
</head>
<body>
<div id="in-page-notification" class="in-page-notification"><span id="notification-message"></span><button class="close-btn">&times;</button></div>
<div class="wrapper">
    <header>
        <nav>
            <ul>
                <li><a href="index.html">Generador de progresiones</a></li>
                <li><a href="Index2.html">Generador de partituras</a></li>
                <li><a href="Index3.html">Generador de ondas</a></li>
                <li><a href="index4.html">Círculo de quintas</a></li>
                <li><a href="#" class="active-nav-link">Generador de cifrados</a></li>
            </ul>
        </nav>
    </header>
</div>

<!-- Controles Flotantes para Cifrados -->
<div class="floating-controls-container">
    <!-- Controles de Vista/Display -->
    <div class="control-group">
        <label for="font-size-selector">Zoom General</label>
        <select id="font-size-selector">
            <option value="50%">50%</option>
            <option value="60%">60%</option>
            <option value="70%">70%</option>
            <option value="80%">80%</option>
            <option value="90%">90%</option>
            <option value="100%" selected>100%</option>
            <option value="110%">110%</option>
            <option value="120%">120%</option>
            <option value="130%">130%</option>
            <option value="140%">140%</option>
            <option value="150%">150%</option>
            <option value="160%">160%</option>
            <option value="170%">170%</option>
            <option value="180%">180%</option>
            <option value="190%">190%</option>
            <option value="200%">200%</option>
        </select>
    </div>

    <div class="control-group">
        <label for="measure-font-size-slider">Tamaño Fuente Compás</label>
        <input type="range" id="measure-font-size-slider" min="0.8" max="3.0" step="0.1" value="1.8">
    </div>

    <div class="control-group">
        <label for="measure-height-slider">Altura Compás</label>
        <input type="range" id="measure-height-slider" min="40" max="120" step="5" value="80">
    </div>

    <!-- Controles de Edición de Compases -->
    <div class="control-group">
        <button id="add-start-repeat-btn" class="btn-measure-edit">Inicio Repetición</button>
        <button id="add-end-repeat-btn" class="btn-measure-edit">Fin Repetición</button>
        <button id="clear-measure-btn" class="btn-danger">Limpiar Compás</button>
        <button id="delete-measure-btn" class="btn-danger">Eliminar Compás</button>
        <button id="add-measure-btn" class="btn-measure-edit">Agregar Compás</button>
    </div>

    <!-- Controles de Edición de Estructura -->
    <div class="control-group">
        <button id="add-row-btn" class="btn-structure-edit">Agregar Fila</button>
        <button id="add-section-btn" class="btn-structure-edit">Agregar Sección</button>
        <button id="delete-row-btn" class="btn-danger">Eliminar Fila</button>
        <button id="delete-section-btn" class="btn-danger">Eliminar Sección</button>
    </div>

    <!-- Controles de Metrónomo -->
    <div class="control-group">
        <label for="metronome-bpm-slider">BPM:</label>
        <input type="range" id="metronome-bpm-slider" value="120" min="40" max="240">
        <input type="number" id="metronome-bpm-input" value="120" min="40" max="240" style="width: 60px;">
        <label for="metronome-volume-slider">Volumen Metrónomo:</label>
        <input type="range" id="metronome-volume-slider" min="-60" max="6" value="-10">
    </div>

    <!-- Controles de Transposición -->
    <div class="control-group">
        <button id="transpose-down-btn" class="btn-measure-edit">-1 Semitono</button>
        <button id="transpose-up-btn" class="btn-measure-edit">+1 Semitono</button>
    </div>

    <!-- Acciones de Documento/Globales -->
    <div class="control-group">
        <button id="add-comment-btn" class="btn-comment">Insertar Comentario</button>
        <button id="export-pdf-btn" class="btn-export">Exportar como PDF</button>
        <button id="reset-chart-btn" class="btn-danger">Reiniciar Partitura</button>
    </div>
</div>

<!-- Controles de Guardado a la Derecha -->
<div class="right-controls-container">
    <div class="control-group">
        <button id="save-chart-btn" class="btn-action">Guardar</button>
        <button id="open-load-chart-modal-btn" class="btn-structure-edit">Cargar</button>
    </div>
</div>

<!-- Modal para Cargar Partituras -->
<div id="load-chart-modal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close-button" id="load-chart-modal-close-btn">&times;</span>
        <h2>Cargar Partitura</h2>
        <input type="text" id="chart-search-input" placeholder="Buscar por nombre o banda..." style="width: 100%; padding: 8px; margin-bottom: 10px;">
        <div id="chart-list-container" class="chart-list">
            <!-- La lista de partituras se generará aquí -->
        </div>
    </div>
</div>

<!-- Modal para Guardar Partituras -->
<div id="save-chart-modal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close-button" id="save-chart-modal-close-btn">&times;</span>
        <h2>Guardar Partitura</h2>
        <div class="control-group">
            <label for="existing-folder-select">Guardar en carpeta existente:</label>
            <select id="existing-folder-select">
                <option value="">Seleccionar carpeta...</option>
            </select>
        </div>
        <div class="control-group">
            <label for="new-folder-input">O crear una nueva carpeta:</label>
            <input type="text" id="new-folder-input" placeholder="Nombre de la nueva carpeta...">
        </div>
        <button id="confirm-save-btn" class="btn-action" style="margin-top: 15px;">Confirmar Guardado</button>
    </div>
</div>

<div class="chart-wrapper">
    <div class="playback-controls">
        <button id="play-progression-btn" class="btn-structure-edit">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-play-fill" viewBox="0 0 16 16">
              <path d="m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z"/>
            </svg>
        </button>
        <input type="checkbox" id="loop-progression-checkbox">
        <label for="loop-progression-checkbox">Loop</label>
    </div>
<div id="chart-container">
    <h1 id="song-title" contenteditable="true">Nombre de la Canción</h1>
    <div class="song-section">
        <h2 contenteditable="true">Intro</h2>
        <div class="measure-row">
            <div class="measure" contenteditable="true">Cmaj7</div>
            <div class="measure" contenteditable="true">Fmaj7</div>
            <div class="measure" contenteditable="true">Dm7</div>
            <div class="measure" contenteditable="true">G7</div>
        </div>
    </div>
</main>
</div>

<script src="https://unpkg.com/tone@14.7.58/build/Tone.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="assets/cifrados.js"></script>
    <!-- Botón Flotante de Reloj -->
    <button id="floating-clock-btn" class="floating-clock-btn" onclick="handleClockButtonClick()">
        <i class="fas fa-clock"></i>
    </button>
    <script src="assets/registro_de_tiempo.js"></script>
    <!-- Time Tracker Modal -->
    <div id="time-tracker-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close-button" id="time-tracker-close-btn">&times;</span>
            <h2>Registro de Estudio</h2>
            <div class="control-group">
                <label for="time-tracker-minutes">Tiempo:</label>
                <input type="number" id="time-tracker-minutes" value="15" min="1">
                <select id="time-tracker-unit">
                    <option value="minutes">Minutos</option>
                    <option value="seconds">Segundos</option>
                </select>
            </div>
            <div id="time-tracker-display">15:00</div>
            <div class="control-group">
                <button id="time-tracker-start-btn" type="button">Iniciar</button>
                <button id="time-tracker-stop-btn" type="button" style="display: none;">Detener</button>
            </div>
        </div>
    </div>

</body>
</html>
